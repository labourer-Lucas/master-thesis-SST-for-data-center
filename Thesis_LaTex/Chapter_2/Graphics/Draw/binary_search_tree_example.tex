\begin{tikzpicture}[scale = 0.9]
%Definitions
\def \rectanglewidth {3}								%Width of the rectangle
\def \rectangleheight {2}								%Height of the rectangle
\def \vertdist {0.75}										%Distance of iterations (vertical)
\def \hordist {0.5}											%Distance of possibilities (horizontal)

%Coordinates (bottom left) of the rectangles
\coordinate (iter_first_one) at (-0.5*\rectanglewidth, -0.5*\rectangleheight);
\coordinate (iter_second_one) at (-\rectanglewidth-0.5*\hordist, -1.5*\rectangleheight-\vertdist);
\coordinate (iter_second_two) at ($(iter_second_one) + (\rectanglewidth+\hordist, 0)$);
\coordinate (iter_third_one) at (-2*\rectanglewidth-1.5*\hordist, -2.5*\rectangleheight-2*\vertdist);
\coordinate (iter_third_two) at ($(iter_third_one) + (\rectanglewidth+\hordist, 0)$);
\coordinate (iter_third_three) at ($(iter_third_two) + (\rectanglewidth+\hordist, 0)$);
\coordinate (iter_third_four) at ($(iter_third_three) + (\rectanglewidth+\hordist, 0)$);
\coordinate (iter_final_one) at (-1.5*\rectanglewidth-\hordist, -3.5*\rectangleheight-3*\vertdist);
\coordinate (iter_final_two) at ($(iter_final_one) + (\rectanglewidth+\hordist, 0)$);

%Draw the state variable axes for the first (initial) rectangle
\draw[-triangle 45] (0.5*\rectanglewidth+0.2, -0.5*\rectangleheight) -- ++(0.6, 0) node[right] {$x_2$};
\draw[-triangle 45] (-0.5*\rectanglewidth, 0.5*\rectangleheight+0.2) -- ++(0, 0.6) node[above] {$x_1$};

%Draw the iteration arrow
\draw[-triangle 45] (-2*\rectanglewidth-1.5*\hordist-0.75, 0.5*\vertdist) node[above] {Iteration} -- +(0, -3*\rectangleheight-4.5*\vertdist);
\node[right] at (-2*\rectanglewidth-1.5*\hordist-0.75, 0) {0};
\node[right] at (-2*\rectanglewidth-1.5*\hordist-0.75, -1*\rectangleheight-\vertdist) {$1$};
\node[right] at (-2*\rectanglewidth-1.5*\hordist-0.75, -2*\rectangleheight-2*\vertdist) {$2$};
\node[right] at (-2*\rectanglewidth-1.5*\hordist-0.75, -3*\rectangleheight-3*\vertdist) {$3$};

%Points on the rectangle which are limiting the regions
\coordinate (bot_lim) at (0.75, 0);
\coordinate (right_lim) at (\rectanglewidth, 0.75);
\coordinate (left_lim) at (0, 1);
\coordinate (topleft_lim) at (0.5, \rectangleheight);
\coordinate (topright_lim) at (\rectanglewidth-0.5, \rectangleheight);

%Points on the rectangle which are only necessary for determining the intersections
\coordinate (int_bot_lim) at (1.5, 0);
\coordinate (int_topleft_lim) at (1, \rectangleheight);
\coordinate (int_topright_lim) at (2, \rectangleheight);

%determine the intersection between the lines
\coordinate (int_bot) at (intersection 1 of bot_lim--topright_lim and int_bot_lim--topleft_lim);
\coordinate (int_right) at (intersection 2 of right_lim--topleft_lim and bot_lim--topright_lim);
\coordinate (int_left) at (intersection 3 of left_lim--int_topright_lim and int_bot_lim--topleft_lim);

%Fill the initial rectangle
\path[fill = lightgray] ($(iter_first_one) + (bot_lim)$) -- ($(iter_first_one) + (\rectanglewidth, 0)$) -- ($(iter_first_one) + (right_lim)$) -- ($(iter_first_one) + (int_right)$) -- cycle;
\path[fill = red] ($(iter_first_one) + (right_lim)$) -- ($(iter_first_one) + (\rectanglewidth, \rectangleheight)$) -- ($(iter_first_one) + (topright_lim)$) -- ($(iter_first_one) + (int_right)$) -- cycle;
\path[fill = cyan] ($(iter_first_one) + (topright_lim)$) -- ($(iter_first_one) + (topleft_lim)$) -- ($(iter_first_one) + (int_bot)$) -- cycle;
\path[fill = lime] ($(iter_first_one) + (left_lim)$) -- ($(iter_first_one) + (int_left)$) -- ($(iter_first_one) + (topleft_lim)$) -- ($(iter_first_one) + (0, \rectangleheight)$) -- cycle;
\path[fill = orange] (iter_first_one) -- ($(iter_first_one) + (bot_lim)$) -- ($(iter_first_one) + (int_bot)$) -- ($(iter_first_one) + (int_left)$) -- ($(iter_first_one) + (left_lim)$) -- cycle;

%Region numbers for the first rectangle
\node at ($(iter_first_one) + (0.3, 1.6)$) {$1$};
\node at ($(iter_first_one) + (0.5, 0.65)$) {$2$};
\node at ($(iter_first_one) + (0.45*\rectanglewidth, 1.5)$) {$3$};
\node at ($(iter_first_one) + (0.85*\rectanglewidth, 1.45)$) {$4$};
\node at ($(iter_first_one) + (0.67*\rectanglewidth, 0.53)$) {$5$};

%Draw the first hyperplane in the initial rectangle
\begin{scope}
\clip (iter_first_one) rectangle ($(iter_first_one) + (\rectanglewidth, \rectangleheight)$);
\draw[dashed, very thick] ($(iter_first_one) + (bot_lim)$) -- ($(iter_first_one) + (topright_lim)$);
\end{scope}

%Fill the rectangles for the first iteration
\foreach \x in {0, ..., 1}
{
\coordinate (zero) at ($(iter_second_one) + (\x*\rectanglewidth+\x*\hordist, 0)$);

%Fill the rectangles
\path[fill = lightgray] ($(zero) + (bot_lim)$) -- ($(zero) + (\rectanglewidth, 0)$) -- ($(zero) + (right_lim)$) -- ($(zero) + (int_right)$) -- cycle;
\path[fill = red] ($(zero) + (right_lim)$) -- ($(zero) + (\rectanglewidth, \rectangleheight)$) -- ($(zero) + (topright_lim)$) -- ($(zero) + (int_right)$) -- cycle;
\path[fill = cyan] ($(zero) + (topright_lim)$) -- ($(zero) + (topleft_lim)$) -- ($(zero) + (int_bot)$) -- cycle;
\path[fill = lime] ($(zero) + (left_lim)$) -- ($(zero) + (int_left)$) -- ($(zero) + (topleft_lim)$) -- ($(zero) + (0, \rectangleheight)$) -- cycle;
\path[fill = orange] (zero) -- ($(zero) + (bot_lim)$) -- ($(zero) + (int_bot)$) -- ($(zero) + (int_left)$) -- ($(zero) + (left_lim)$) -- cycle;

%Region numbers for the rectangles
\node at ($(zero) + (0.3, 1.6)$) {$1$};
\node at ($(zero) + (0.5, 0.65)$) {$2$};
\node at ($(zero) + (0.45*\rectanglewidth, 1.5)$) {$3$};
\node at ($(zero) + (0.85*\rectanglewidth, 1.45)$) {$4$};
\node at ($(zero) + (0.67*\rectanglewidth, 0.53)$) {$5$};
}

%First iteration, first (left) rectangle: Regions 4 and 5 cut away
\draw[-, fill = white] ($(iter_second_one) + (bot_lim)$) -- ($(iter_second_one) + (\rectanglewidth, 0)$) -- ($(iter_second_one) + (\rectanglewidth, \rectangleheight)$) -- ($(iter_second_one) + (topright_lim)$) -- cycle;
\begin{scope}
\clip (iter_second_one) rectangle ($(iter_second_one) + (\rectanglewidth, \rectangleheight)$);
\draw[dashed, very thick] ($(iter_second_one) + (topleft_lim)$) -- ($(iter_second_one) + (int_bot)$);
\end{scope}

%Second iteration, second (right) rectangle: Regions 4 and 5 left
\draw[-, fill = white] (iter_second_two) -- ($(iter_second_two) + (bot_lim)$) -- ($(iter_second_two) + (topright_lim)$) -- ($(iter_second_two) + (0, \rectangleheight)$) -- cycle;
\begin{scope}
\clip (iter_second_two) rectangle ($(iter_second_two) + (\rectanglewidth, \rectangleheight)$);
\draw[dashed, very thick] ($(iter_second_two) + (int_right)$) -- ($(iter_second_two) + (right_lim)$);
\end{scope}

%Second iteration, first (left) rectangle: Region 3
\draw[-, fill = cyan] ($(iter_third_one) + (topright_lim)$) -- ($(iter_third_one) + (topleft_lim)$) -- ($(iter_third_one) + (int_bot)$) -- cycle;
\node at ($(iter_third_one) + (0.45*\rectanglewidth, 1.5)$) {$3$};

%Second iteration, second rectangle: Regions 1 and 2 left
\path[fill = lime] ($(iter_third_two) + (left_lim)$) -- ($(iter_third_two) + (int_left)$) -- ($(iter_third_two) + (topleft_lim)$) -- ($(iter_third_two) + (0, \rectangleheight)$) -- cycle;
\path[fill = orange] (iter_third_two) -- ($(iter_third_two) + (bot_lim)$) -- ($(iter_third_two) + (int_bot)$) -- ($(iter_third_two) + (int_left)$) -- ($(iter_third_two) + (left_lim)$) -- cycle;
\node at ($(iter_third_two) + (0.3, 1.6)$) {$1$};
\node at ($(iter_third_two) + (0.5, 0.65)$) {$2$};
\draw[-] (iter_third_two) -- ($(iter_third_two) + (bot_lim)$) -- ($(iter_third_two) + (int_bot)$) -- ($(iter_third_two) + (topleft_lim)$) -- ($(iter_third_two) + (0, \rectangleheight)$) -- cycle;
\begin{scope}
\clip (iter_third_two) rectangle ($(iter_third_two) + (\rectanglewidth, \rectangleheight)$);
\draw[dashed, very thick] ($(iter_third_two) + (left_lim)$) -- ($(iter_third_two) + (int_left)$);
\end{scope}

%Second iteration, third rectangle: Region 4
\draw[-, fill = red] ($(iter_third_three) + (right_lim)$) -- ($(iter_third_three) + (\rectanglewidth, \rectangleheight)$) -- ($(iter_third_three) + (topright_lim)$) -- ($(iter_third_three) + (int_right)$) -- cycle;
\node at ($(iter_third_three) + (0.85*\rectanglewidth, 1.45)$) {$4$};

%Second iteration, fourth (right) rectangle: Region 5
\draw[-, fill = lightgray] ($(iter_third_four) + (bot_lim)$) -- ($(iter_third_four) + (\rectanglewidth, 0)$) -- ($(iter_third_four) + (right_lim)$) -- ($(iter_third_four) + (int_right)$) -- cycle;
\node at ($(iter_third_four) + (0.67*\rectanglewidth, 0.53)$) {$5$};

%Third iteration, first (left) rectangle: Region 1
\draw[-, fill = lime] ($(iter_final_one) + (left_lim)$) -- ($(iter_final_one) + (int_left)$) -- ($(iter_final_one) + (topleft_lim)$) -- ($(iter_final_one) + (0, \rectangleheight)$) -- cycle;
\node at ($(iter_final_one) + (0.3, 1.6)$) {$1$};

%Third iteration, second (right) rectangle: Region 2
\draw[-, fill = orange] (iter_final_two) -- ($(iter_final_two) + (bot_lim)$) -- ($(iter_final_two) + (int_bot)$) -- ($(iter_final_two) + (int_left)$) -- ($(iter_final_two) + (left_lim)$) -- cycle;
\node at ($(iter_final_two) + (0.5, 0.65)$) {$2$};

%Draw the rectangles
\draw[-] (iter_first_one) rectangle ($(iter_first_one) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_second_one) rectangle ($(iter_second_one) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_second_two) rectangle ($(iter_second_two) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_third_one) rectangle ($(iter_third_one) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_third_two) rectangle ($(iter_third_two) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_third_three) rectangle ($(iter_third_three) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_third_four) rectangle ($(iter_third_four) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_final_one) rectangle ($(iter_final_one) + (\rectanglewidth, \rectangleheight)$);
\draw[-] (iter_final_two) rectangle ($(iter_final_two) + (\rectanglewidth, \rectangleheight)$);

%Draw the arrows from and to the rectangles
\draw[-triangle 45] ($(iter_first_one) + (0.5*\rectanglewidth-\hordist, 0)$) -- ($(iter_second_one) + (0.5*\rectanglewidth+\hordist, \rectangleheight)$);
\draw[-triangle 45] ($(iter_first_one) + (0.5*\rectanglewidth+\hordist, 0)$) -- ($(iter_second_two) + (0.5*\rectanglewidth-\hordist, \rectangleheight)$);
\draw[-triangle 45] ($(iter_second_one) + (0.5*\rectanglewidth, 0)$) -- ($(iter_third_two) + (0.5*\rectanglewidth, \rectangleheight)$);
\draw[-triangle 45] ($(iter_second_two) + (0.5*\rectanglewidth, 0)$) -- ($(iter_third_three) + (0.5*\rectanglewidth, \rectangleheight)$);
\draw[-triangle 45] ($(iter_second_one) + (0, 0)$) -- ($(iter_third_one) + (\rectanglewidth, \rectangleheight)$);
\draw[-triangle 45] ($(iter_second_two) + (\rectanglewidth, 0)$) -- ($(iter_third_four) + (0, \rectangleheight)$);
\draw[-triangle 45] ($(iter_third_two) + (0.5*\rectanglewidth-\hordist, 0)$) -- ($(iter_final_one) + (0.5*\rectanglewidth+\hordist, \rectangleheight)$);
\draw[-triangle 45] ($(iter_third_two) + (0.5*\rectanglewidth+\hordist, 0)$) -- ($(iter_final_two) + (0.5*\rectanglewidth-\hordist, \rectangleheight)$);
\end{tikzpicture}